# Metasploit Exploitation
- ğŸ” [Port Scanning](https://github.com/Dee-Techie/Cybersecurity-Portfolio/blob/main/Write-Ups/Metasploit-Exploitation.md#-port-scanning-with-metasploit)
- ğŸ§  [Metasploit Database Overview](https://github.com/Dee-Techie/Cybersecurity-Portfolio/blob/main/Write-Ups/Metasploit-Exploitation.md#-metasploit-database-overview)
- ğŸ—‚ï¸ [Workspace Management](https://github.com/Dee-Techie/Cybersecurity-Portfolio/blob/main/Write-Ups/Metasploit-Exploitation.md#%EF%B8%8F-workspace-management)
- âœ… [DB Backend Commands](https://github.com/Dee-Techie/Cybersecurity-Portfolio/blob/main/Write-Ups/Metasploit-Exploitation.md#-database-search-example)

# ğŸ” Port Scanning with Metasploit

Metasploit provides various modules to perform port and service discovery on target systems.

## ğŸ” Finding Port Scanning Modules

Use the `search portscan` command to list relevant modules:
- `portscan/tcp`
- `portscan/syn`
- `portscan/xmas`
- `portscan/ack`
- `portscan/ftpbounce`
- `portscan/natpmp`
- `sap_router_portscanner`

Use modules by index or full path, e.g.:
```bash
use 5
# or
use auxiliary/scanner/portscan/tcp
```

## âš™ï¸ Common Options for Port Scan Modules

| Option       | Description                                                                 |
|--------------|-----------------------------------------------------------------------------|
| `RHOSTS`     | Target hosts or range                                                       |
| `PORTS`      | Ports to scan (e.g., 1â€“10000). Note: Not the same as Nmapâ€™s default top 1000 |
| `THREADS`    | Number of concurrent hosts to scan                                          |
| `CONCURRENCY`| Number of ports per host to scan in parallel                                |
| `TIMEOUT`    | Timeout in milliseconds per connection                                      |
| `DELAY`      | Delay between connections                                                   |
| `JITTER`     | Random variation added to delay                                             |

## ğŸ›°ï¸ Using Nmap from Metasploit

Metasploit allows executing Nmap directly from `msfconsole`:

```bash
msf6 > nmap -sS 10.10.12.229
```

## ğŸ“¡ UDP Scanning

Use `scanner/discovery/udp_sweep` for quick detection of common UDP services (e.g., DNS, NetBIOS).

## ğŸ“ SMB Scanning

Modules like `smb_version` and `smb_enumshares` help detect OS version, share details, and configurations:

```bash
use auxiliary/scanner/smb/smb_version
run
```

## ğŸ§  Pro Tip

Donâ€™t ignore â€œexoticâ€ services like NetBIOS. Look for shared files and indicative system names (e.g., CORP-DC, SALES). Always explore available modules relevant to your target.

---

## ğŸ”¬ Practical Exercise:
Refer to the [link](https://wanderication.medium.com/metasploit-exploitation-scanning-tryhackme-ba3b969e7398)
- How many ports are open on the target system?
  - Method 1: Use Nmap <IP Address> </br>
  ![image](https://github.com/user-attachments/assets/340633d5-dabd-45d7-b3fe-02d98146bbb7)

  - Method 2: Use Metasploit (Follow the steps)
    ```bash
    msfconsole
    search portscan
    use 5
    show options
    set RHOST <machine_ip>
    run
    ```
    ![image](https://github.com/user-attachments/assets/3f10a699-fc19-4711-a7dd-784721c8d55f)
    ![image](https://github.com/user-attachments/assets/1ba9fe42-96f6-4617-84f2-6df6912fb293)

---

# ğŸ§  Metasploit Database Overview

## ğŸ¯ Purpose
The Metasploit database helps manage multi-target environments efficiently, especially during real-world penetration testing engagements.

---

## ğŸ› ï¸ Initialization (For Kali Linux or local setups)

> âœ… Already configured in the THM AttackBox.

1. **Start PostgreSQL**  
   ```bash
   systemctl start postgresql
   ```

2. **Initialize Metasploit DB**  
   ```bash
   sudo -u postgres msfdb init
   ```

3. **To Delete Existing DB**  
   ```bash
   sudo -u postgres msfdb delete
   ```

---

## ğŸ” Verifying Database Connection

```bash
msfconsole
msf6 > db_status
[*] Connected to msf. Connection type: postgresql.
```

---

## ğŸ—‚ï¸ Workspace Management

- **List Workspaces:**  
  ```bash
  workspace
  ```

- **Add New Workspace:**  
  ```bash
  workspace -a tryhackme
  ```

- **Switch Workspace:**  
  ```bash
  workspace tryhackme
  ```

- **Workspace Help:**  
  ```bash
  workspace -h
  ```

---

## ğŸ§° Database Backend Commands

| ğŸ“Œ Command           | ğŸ“ Description |
|------------------|-------------|
| `db_connect`      | Connect to data service |
| `db_nmap`         | Run Nmap & save results |
| `db_import`       | Import scan results |
| `db_export`       | Export DB contents |
| `hosts`           | List all discovered hosts |
| `services`        | List services per host |
| `loot`, `notes`, `vulns` | List respective items |
| `db_status`       | Show DB status |
| `workspace`       | Manage workspaces |

---

## ğŸš€ Example Workflow

1. **Run Nmap Scan (auto-saves results):**
   ```bash
   db_nmap -sV -p- 10.10.12.229
   ```

2. **View Hosts and Services:**
   ```bash
   hosts
   services
   ```

3. **Set RHOSTS from Saved Hosts:**
   ```bash
   use auxiliary/scanner/smb/smb_ms17_010
   hosts -R
   ```

4. **Verify Options:**
   ```bash
   show options
   ```

5. **Run Exploit:**
   ```bash
   run
   ```

---

## ğŸ” Database Search Example

- **Search for NetBIOS Services:**
  ```bash
  services -S netbios
  ```

---

## ğŸ•µï¸ Common Services to Investigate

| ğŸ’» Service | ğŸ”“ Potential |
|-----------|--------------|
| HTTP      | Web app vulnerabilities (e.g., SQLi, RCE) |
| FTP       | Anonymous login, file access |
| SMB       | Vulnerabilities like MS17-010 |
| SSH       | Weak/default credentials |
| RDP       | Vulnerable to BlueKeep or weak passwords |

---



---
<sub>ğŸ”— References & Resources:</sub>
- <sub>TryHackMe â€” Moniker Link | Cyber Security 101 (THM) [TryHackMe](https://tryhackme.com/room/monikerlink)</sub>
- <sub>https://wanderication.medium.com/metasploit-exploitation-scanning-tryhackme-ba3b969e7398</sub>
